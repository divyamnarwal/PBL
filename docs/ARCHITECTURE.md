# ğŸ—ï¸ System Architecture - Carbon Neutrality Dashboard

## ğŸ“ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER BROWSER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Carbon Neutrality SPA                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Login   â”‚  â”‚   Main   â”‚  â”‚   AQI    â”‚  â”‚ Real-Timeâ”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Page    â”‚â†’ â”‚Dashboard â”‚  â”‚Dashboard â”‚  â”‚ CO2 Mon. â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚            JavaScript Modules                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ auth.js (Firebase Auth)                        â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ app.js (Main Logic)                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ mqtt-service.js (MQTT Client) â† NEW           â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ real-time-monitor.js (Dashboard Logic) â† NEW  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                  â”‚
               â”‚ HTTPS            â”‚ WebSocket (ws://localhost:9001)
               â”‚ (Firebase)       â”‚
               â†“                  â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                â”‚  â”‚                  â”‚
      â”‚ Firebase Auth  â”‚  â”‚ Mosquitto MQTT  â”‚
      â”‚    (Cloud)     â”‚  â”‚  Broker (Local)  â”‚
      â”‚                â”‚  â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ MQTT (port 1883)
                                   â”‚
                                   â†“
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  Python Publisher   â”‚
                          â”‚ (air_quality_*.py)  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ UART (/dev/ttyAMA0)
                                     â”‚
                                     â†“
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   MH-Z19 CO2   â”‚
                            â”‚     Sensor     â”‚
                            â”‚ (Raspberry Pi) â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

### Real-Time CO2 Monitoring Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Sensor Reading                                          â”‚
â”‚                                                                  â”‚
â”‚  MH-Z19 Sensor â†’ [UART] â†’ Python Script                         â”‚
â”‚  (Every 2 seconds)                                               â”‚
â”‚                                                                  â”‚
â”‚  CO2: 612 ppm                                                    â”‚
â”‚  Temperature: 23Â°C                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: MQTT Publish                                            â”‚
â”‚                                                                  â”‚
â”‚  Python Script â†’ [MQTT] â†’ Mosquitto Broker                      â”‚
â”‚                                                                  â”‚
â”‚  Topic: "sensor/co2"                                             â”‚
â”‚  Payload: {                                                      â”‚
â”‚    "co2": 612,                                                   â”‚
â”‚    "status": "OK",                                               â”‚
â”‚    "timestamp": "2025-11-09T14:30:00.123Z",                     â”‚
â”‚    "sensor": "MH-Z19"                                            â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: WebSocket Broadcast                                     â”‚
â”‚                                                                  â”‚
â”‚  Mosquitto Broker â†’ [WebSocket:9001] â†’ Browser Clients          â”‚
â”‚                                                                  â”‚
â”‚  All connected clients receive the message                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: JavaScript Processing                                   â”‚
â”‚                                                                  â”‚
â”‚  mqtt-service.js receives message                                â”‚
â”‚  â”œâ”€ Parse JSON                                                   â”‚
â”‚  â”œâ”€ Validate data                                                â”‚
â”‚  â””â”€ Emit event to real-time-monitor.js                          â”‚
â”‚                                                                  â”‚
â”‚  real-time-monitor.js processes event                            â”‚
â”‚  â”œâ”€ Update current CO2 value display                            â”‚
â”‚  â”œâ”€ Add data point to chart buffer                              â”‚
â”‚  â”œâ”€ Update Chart.js visualization                               â”‚
â”‚  â”œâ”€ Calculate statistics (min/max/avg)                          â”‚
â”‚  â”œâ”€ Check alert thresholds                                      â”‚
â”‚  â””â”€ Update UI with color coding                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: User Interface Update                                   â”‚
â”‚                                                                  â”‚
â”‚  Dashboard displays:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ğŸŸ¢ Connected                             â”‚                   â”‚
â”‚  â”‚                                          â”‚                   â”‚
â”‚  â”‚      612 PPM                             â”‚                   â”‚
â”‚  â”‚      COâ‚‚ Level                           â”‚                   â”‚
â”‚  â”‚                                          â”‚                   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                   â”‚
â”‚  â”‚  â”‚  [Chart: Last 30 minutes]       â”‚    â”‚                   â”‚
â”‚  â”‚  â”‚                              /\  â”‚    â”‚                   â”‚
â”‚  â”‚  â”‚                          /\  /  \â”‚    â”‚                   â”‚
â”‚  â”‚  â”‚                      /\  /  \/   â”‚    â”‚                   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€/â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚                   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                   â”‚
â”‚  â”‚                                          â”‚                   â”‚
â”‚  â”‚  Status: Good Air Quality âœ“              â”‚                   â”‚
â”‚  â”‚  Last Update: 2 seconds ago              â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER JOURNEY                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User visits  â”‚
â”‚  website     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check if authenticated?          â”‚
â”‚ (onAuthStateChanged)             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚           â”‚
       NO          YES
       â”‚           â”‚
       â†“           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redirect â”‚   â”‚ Show Dashboard   â”‚
â”‚ to Login â”‚   â”‚ Initialize MQTT  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚
     â†“                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ Login Page       â”‚    â”‚
â”‚ â€¢ Enter email    â”‚    â”‚
â”‚ â€¢ Enter password â”‚    â”‚
â”‚ â€¢ Click login    â”‚    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
     â”‚                  â”‚
     â†“                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ Firebase Auth    â”‚    â”‚
â”‚ Verification     â”‚    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
     â”‚                  â”‚
     â”‚ SUCCESS          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard Loaded                â”‚
â”‚ 1. Show loading spinner         â”‚
â”‚ 2. Initialize MQTT service      â”‚
â”‚ 3. Connect to broker            â”‚
â”‚ 4. Subscribe to sensor/co2      â”‚
â”‚ 5. Start chart visualization    â”‚
â”‚ 6. Hide loading spinner         â”‚
â”‚ 7. Show real-time data          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ User clicks Logout
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cleanup                         â”‚
â”‚ 1. Disconnect MQTT              â”‚
â”‚ 2. Clear chart data             â”‚
â”‚ 3. Sign out from Firebase       â”‚
â”‚ 4. Redirect to login            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ File Structure (After Phase 1)

```
d:\carbon-frontend\
â”‚
â”œâ”€â”€ ğŸ“„ INTEGRATION_PLAN.md          â† Detailed implementation plan
â”œâ”€â”€ ğŸ“„ QUICK_REFERENCE.md           â† Command reference
â”œâ”€â”€ ğŸ“„ ARCHITECTURE.md              â† This file
â”œâ”€â”€ ğŸ“„ README.md                    â† Project overview
â”œâ”€â”€ ğŸ“„ package.json                 â† (Optional) NPM dependencies
â”œâ”€â”€ ğŸ“„ .gitignore
â”œâ”€â”€ ğŸ“„ .env.example                 â† Environment variables template
â”‚
â”œâ”€â”€ ğŸ“ public/                      â† Static HTML files
â”‚   â”œâ”€â”€ index.html                  â† Landing/redirect page
â”‚   â”œâ”€â”€ login.html                  â† Login page
â”‚   â”œâ”€â”€ signup.html                 â† Signup page
â”‚   â””â”€â”€ dashboard.html              â† Main SPA (renamed from carbon_neutrality.html)
â”‚
â”œâ”€â”€ ğŸ“ js/                          â† JavaScript modules
â”‚   â”œâ”€â”€ firebase.js                 â† Firebase config (existing)
â”‚   â”œâ”€â”€ auth.js                     â† Authentication logic (existing)
â”‚   â”œâ”€â”€ app.js                      â† Main app logic (existing)
â”‚   â”œâ”€â”€ mqtt-service.js             â† ğŸ†• MQTT client wrapper
â”‚   â””â”€â”€ real-time-monitor.js        â† ğŸ†• Real-time dashboard logic
â”‚
â”œâ”€â”€ ğŸ“ css/                         â† (Optional) Custom styles
â”‚   â””â”€â”€ custom.css
â”‚
â”œâ”€â”€ ğŸ“ backend/                     â† Python sensor scripts
â”‚   â”œâ”€â”€ air_quality_mhz19_mqtt.py   â† MQTT publisher
â”‚   â”œâ”€â”€ air_quality_mhz19.py        â† Direct sensor reader
â”‚   â”œâ”€â”€ config.py                   â† ğŸ†• Configuration
â”‚   â”œâ”€â”€ requirements.txt            â† Python dependencies
â”‚   â””â”€â”€ .env                        â† Environment variables (gitignored)
â”‚
â”œâ”€â”€ ğŸ“ scripts/                     â† Helper scripts
â”‚   â”œâ”€â”€ start_sensor.sh             â† Start sensor (Linux/Mac)
â”‚   â”œâ”€â”€ start-sensor.ps1            â† ğŸ†• Start sensor (Windows)
â”‚   â”œâ”€â”€ start_dashboard.sh          â† Start dashboard (Linux/Mac)
â”‚   â”œâ”€â”€ setup_mqtt.sh               â† ğŸ†• MQTT setup (Linux/Mac)
â”‚   â””â”€â”€ simulate-sensor.js          â† ğŸ†• Simulate sensor for testing
â”‚
â”œâ”€â”€ ğŸ“ docs/                        â† Documentation
â”‚   â”œâ”€â”€ QUICKSTART.md               â† Quick start guide
â”‚   â”œâ”€â”€ MQTT_SETUP.md               â† ğŸ†• MQTT setup guide
â”‚   â”œâ”€â”€ DEPLOYMENT.md               â† ğŸ†• Deployment guide
â”‚   â””â”€â”€ TROUBLESHOOTING.md          â† ğŸ†• Common issues
â”‚
â””â”€â”€ ğŸ“ tests/                       â† (Optional) Test files
    â”œâ”€â”€ mqtt-service.test.js
    â””â”€â”€ real-time-monitor.test.js
```

---

## ğŸ”Œ MQTT Architecture

### Broker Configuration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Mosquitto MQTT Broker                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Port 1883        â”‚      â”‚   Port 9001        â”‚        â”‚
â”‚  â”‚   MQTT Protocol    â”‚      â”‚   WebSocket        â”‚        â”‚
â”‚  â”‚   (for Python)     â”‚      â”‚   (for Browser)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚            â”‚                           â”‚                    â”‚
â”‚            â”‚                           â”‚                    â”‚
â”‚            â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                    â”‚
â”‚            â””â”€â”€â”€â”€â”¤   Topic:     â”œâ”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                 â”‚  sensor/co2  â”‚                            â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                              â”‚
â”‚  Configuration: /etc/mosquitto/conf.d/websocket.conf        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ listener 9001                                  â”‚        â”‚
â”‚  â”‚ protocol websockets                            â”‚        â”‚
â”‚  â”‚ listener 1883                                  â”‚        â”‚
â”‚  â”‚ protocol mqtt                                  â”‚        â”‚
â”‚  â”‚ allow_anonymous true                           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Topic Structure

```
sensor/
â”œâ”€â”€ co2                      â† Main CO2 readings
â”‚   Payload: { co2, status, timestamp, sensor }
â”‚
â”œâ”€â”€ co2/raw                  â† (Future) Raw sensor data
â”œâ”€â”€ co2/calibration          â† (Future) Calibration data
â”œâ”€â”€ co2/alerts               â† (Future) Alert messages
â””â”€â”€ co2/status               â† (Future) Sensor health status
```

---

## ğŸ¨ Component Hierarchy

```
Dashboard.html
â”‚
â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Logo
â”‚   â”œâ”€â”€ Navigation Menu
â”‚   â”‚   â”œâ”€â”€ Home
â”‚   â”‚   â”œâ”€â”€ Dashboard
â”‚   â”‚   â”œâ”€â”€ Calculator
â”‚   â”‚   â””â”€â”€ About
â”‚   â”œâ”€â”€ Theme Toggle (Dark/Light)
â”‚   â””â”€â”€ Logout Button
â”‚
â”œâ”€â”€ Hero Section
â”‚   â””â”€â”€ Welcome Message
â”‚
â”œâ”€â”€ AQI Dashboard (Existing)
â”‚   â”œâ”€â”€ City Input
â”‚   â”œâ”€â”€ Search Button
â”‚   â”œâ”€â”€ AQI Value Display
â”‚   â”œâ”€â”€ Pollutant Details
â”‚   â””â”€â”€ Air Quality Chart
â”‚
â”œâ”€â”€ ğŸ†• Real-Time CO2 Monitor Section
â”‚   â”œâ”€â”€ Section Header
â”‚   â”‚   â”œâ”€â”€ Title: "Live CO2 Monitoring"
â”‚   â”‚   â””â”€â”€ Connection Status Indicator
â”‚   â”‚
â”‚   â”œâ”€â”€ Stats Grid
â”‚   â”‚   â”œâ”€â”€ Current CO2 Card
â”‚   â”‚   â”‚   â”œâ”€â”€ Large CO2 Value
â”‚   â”‚   â”‚   â”œâ”€â”€ Unit (PPM)
â”‚   â”‚   â”‚   â”œâ”€â”€ Quality Badge (Good/Moderate/Poor)
â”‚   â”‚   â”‚   â””â”€â”€ Last Update Time
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Statistics Card
â”‚   â”‚   â”‚   â”œâ”€â”€ Today's Min
â”‚   â”‚   â”‚   â”œâ”€â”€ Today's Max
â”‚   â”‚   â”‚   â””â”€â”€ Today's Average
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Sensor Info Card
â”‚   â”‚       â”œâ”€â”€ Sensor Model
â”‚   â”‚       â”œâ”€â”€ Status (Active/Warmup/Error)
â”‚   â”‚       â””â”€â”€ Connection Quality
â”‚   â”‚
â”‚   â”œâ”€â”€ Trend Chart Container
â”‚   â”‚   â”œâ”€â”€ Chart Canvas
â”‚   â”‚   â”œâ”€â”€ Time Range Selector (15min/30min/1hour)
â”‚   â”‚   â””â”€â”€ Export Button (CSV/PNG)
â”‚   â”‚
â”‚   â””â”€â”€ Alerts Panel
â”‚       â”œâ”€â”€ Current Alerts
â”‚       â””â”€â”€ Alert History
â”‚
â”œâ”€â”€ Carbon Calculator (Existing)
â”‚   â””â”€â”€ ... (unchanged)
â”‚
â”œâ”€â”€ Educational Content (Existing)
â”‚   â””â”€â”€ ... (unchanged)
â”‚
â””â”€â”€ Footer
    â””â”€â”€ ... (unchanged)
```

---

## ğŸ’¾ Data Management

### Client-Side Data Storage

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser Storage Strategy                                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LocalStorage                                         â”‚  â”‚
â”‚  â”‚ â€¢ User preferences (theme, units)                   â”‚  â”‚
â”‚  â”‚ â€¢ Last known good MQTT config                       â”‚  â”‚
â”‚  â”‚ â€¢ Chart settings                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ SessionStorage                                       â”‚  â”‚
â”‚  â”‚ â€¢ Current session data                              â”‚  â”‚
â”‚  â”‚ â€¢ Temporary chart data                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ In-Memory (JavaScript)                               â”‚  â”‚
â”‚  â”‚ â€¢ MQTT connection object                            â”‚  â”‚
â”‚  â”‚ â€¢ Real-time data buffer (last 100 readings)         â”‚  â”‚
â”‚  â”‚ â€¢ Chart instance                                    â”‚  â”‚
â”‚  â”‚ â€¢ WebSocket connection                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Buffer Management

```javascript
class DataBuffer {
  constructor(maxSize = 100) {
    this.data = [];
    this.maxSize = maxSize;
  }
  
  add(dataPoint) {
    this.data.push(dataPoint);
    if (this.data.length > this.maxSize) {
      this.data.shift(); // Remove oldest
    }
  }
  
  getRecent(count = 50) {
    return this.data.slice(-count);
  }
  
  getStats() {
    const values = this.data.map(d => d.co2);
    return {
      min: Math.min(...values),
      max: Math.max(...values),
      avg: values.reduce((a, b) => a + b, 0) / values.length
    };
  }
}
```

---

## ğŸ”„ State Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Application State                                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Authentication State                                 â”‚  â”‚
â”‚  â”‚ â€¢ isAuthenticated: boolean                          â”‚  â”‚
â”‚  â”‚ â€¢ currentUser: User | null                          â”‚  â”‚
â”‚  â”‚ â€¢ loading: boolean                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MQTT Connection State                                â”‚  â”‚
â”‚  â”‚ â€¢ status: 'disconnected' | 'connecting' |           â”‚  â”‚
â”‚  â”‚           'connected' | 'error'                     â”‚  â”‚
â”‚  â”‚ â€¢ lastError: Error | null                           â”‚  â”‚
â”‚  â”‚ â€¢ reconnectAttempts: number                         â”‚  â”‚
â”‚  â”‚ â€¢ messageCount: number                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Sensor Data State                                    â”‚  â”‚
â”‚  â”‚ â€¢ currentReading: Reading | null                    â”‚  â”‚
â”‚  â”‚ â€¢ historicalData: Reading[]                         â”‚  â”‚
â”‚  â”‚ â€¢ statistics: { min, max, avg }                     â”‚  â”‚
â”‚  â”‚ â€¢ alerts: Alert[]                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ UI State                                             â”‚  â”‚
â”‚  â”‚ â€¢ theme: 'light' | 'dark'                           â”‚  â”‚
â”‚  â”‚ â€¢ activeSection: string                             â”‚  â”‚
â”‚  â”‚ â€¢ chartTimeRange: '15min' | '30min' | '1hour'      â”‚  â”‚
â”‚  â”‚ â€¢ showAlerts: boolean                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Event Flow

```
User Action â†’ Event â†’ Handler â†’ State Update â†’ UI Update

Examples:

1. Page Load
   Window.onload
   â†’ initApp()
   â†’ checkAuth()
   â†’ initMQTT()
   â†’ updateUI()

2. MQTT Message Received
   WebSocket.onmessage
   â†’ mqtt-service.onMessage()
   â†’ parseData()
   â†’ real-time-monitor.updateData()
   â†’ updateChart()
   â†’ updateStats()
   â†’ checkAlerts()

3. User Logout
   Button.click
   â†’ auth.logout()
   â†’ mqtt-service.disconnect()
   â†’ clearState()
   â†’ redirect('/login')

4. Connection Lost
   WebSocket.onclose
   â†’ mqtt-service.onDisconnect()
   â†’ showReconnectMessage()
   â†’ attemptReconnect()
   â†’ updateStatusIndicator()
```

---

## ğŸ›¡ï¸ Security Considerations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Layers                                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. Authentication (Firebase)                         â”‚  â”‚
â”‚  â”‚    â€¢ Email/password authentication                   â”‚  â”‚
â”‚  â”‚    â€¢ Token-based session management                  â”‚  â”‚
â”‚  â”‚    â€¢ Automatic token refresh                         â”‚  â”‚
â”‚  â”‚    â€¢ Protected routes                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. MQTT Security                                     â”‚  â”‚
â”‚  â”‚    â€¢ Local network only (localhost)                  â”‚  â”‚
â”‚  â”‚    â€¢ WebSocket over ws:// (local)                    â”‚  â”‚
â”‚  â”‚    â€¢ For production: wss:// (encrypted)              â”‚  â”‚
â”‚  â”‚    â€¢ Username/password (production)                  â”‚  â”‚
â”‚  â”‚    â€¢ TLS certificates (production)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. Data Validation                                   â”‚  â”‚
â”‚  â”‚    â€¢ Input sanitization                              â”‚  â”‚
â”‚  â”‚    â€¢ JSON schema validation                          â”‚  â”‚
â”‚  â”‚    â€¢ Range checking (CO2: 400-5000 ppm)             â”‚  â”‚
â”‚  â”‚    â€¢ Type checking                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 4. Error Handling                                    â”‚  â”‚
â”‚  â”‚    â€¢ Try-catch blocks                                â”‚  â”‚
â”‚  â”‚    â€¢ Error boundaries                                â”‚  â”‚
â”‚  â”‚    â€¢ Graceful degradation                            â”‚  â”‚
â”‚  â”‚    â€¢ User-friendly error messages                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance Optimization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Optimization Strategies                                     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. Data Throttling                                   â”‚  â”‚
â”‚  â”‚    â€¢ Buffer updates: every 2 seconds                 â”‚  â”‚
â”‚  â”‚    â€¢ Chart updates: every 1 second                   â”‚  â”‚
â”‚  â”‚    â€¢ Stats recalculation: every 5 seconds            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. Memory Management                                 â”‚  â”‚
â”‚  â”‚    â€¢ Circular buffer (max 100 readings)              â”‚  â”‚
â”‚  â”‚    â€¢ Cleanup on disconnect                           â”‚  â”‚
â”‚  â”‚    â€¢ WeakMap for temporary data                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. Chart Optimization                                â”‚  â”‚
â”‚  â”‚    â€¢ Canvas rendering (faster than SVG)              â”‚  â”‚
â”‚  â”‚    â€¢ Decimation plugin (reduce data points)          â”‚  â”‚
â”‚  â”‚    â€¢ Animation: false (for updates)                  â”‚  â”‚
â”‚  â”‚    â€¢ Responsive: true (resize handling)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 4. Network Optimization                              â”‚  â”‚
â”‚  â”‚    â€¢ WebSocket (persistent connection)               â”‚  â”‚
â”‚  â”‚    â€¢ Binary encoding (future)                        â”‚  â”‚
â”‚  â”‚    â€¢ Compression (future)                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”® Future Enhancements

```
Phase 9: Multi-Sensor Support
â”œâ”€â”€ Multiple CO2 sensors
â”œâ”€â”€ Temperature sensors
â”œâ”€â”€ Humidity sensors
â””â”€â”€ PM2.5/PM10 sensors

Phase 10: Data Persistence
â”œâ”€â”€ Backend database (MongoDB/PostgreSQL)
â”œâ”€â”€ Historical data storage
â”œâ”€â”€ Data export (CSV, JSON, PDF)
â””â”€â”€ Data analytics dashboard

Phase 11: Advanced Features
â”œâ”€â”€ Machine learning predictions
â”œâ”€â”€ Anomaly detection
â”œâ”€â”€ Automated ventilation control
â”œâ”€â”€ Mobile app (React Native)
â””â”€â”€ Email/SMS alerts

Phase 12: Multi-User Support
â”œâ”€â”€ User roles (admin, viewer)
â”œâ”€â”€ Multiple locations
â”œâ”€â”€ Shared dashboards
â””â”€â”€ Team collaboration
```

---

## ğŸ“ˆ Scalability Considerations

```
Current: Single Sensor, Single User
â””â”€â”€ Works for: Home, small office

Future: Multi-Sensor, Multi-User
â”œâ”€â”€ Database layer (store historical data)
â”œâ”€â”€ API layer (REST/GraphQL)
â”œâ”€â”€ Message queue (RabbitMQ/Redis)
â”œâ”€â”€ Load balancer
â””â”€â”€ Works for: Buildings, campuses, cities
```

---

## ğŸ“ Learning Resources

### MQTT
- [MQTT.org](https://mqtt.org/) - Official MQTT documentation
- [Mosquitto Docs](https://mosquitto.org/documentation/) - Broker documentation
- [MQTT.js](https://github.com/mqttjs/MQTT.js) - JavaScript client library

### Chart.js
- [Chart.js Docs](https://www.chartjs.org/docs/latest/) - Official documentation
- [Real-time Chart](https://www.chartjs.org/docs/latest/samples/advanced/progress-bar.html) - Real-time examples

### CO2 Monitoring
- [CO2 Levels Guide](https://www.kane.co.uk/knowledge-centre/what-are-safe-levels-of-co-and-co2-in-rooms) - Health standards
- [MH-Z19 Datasheet](https://www.winsen-sensor.com/d/files/mh-z19b-co2-ver1_0.pdf) - Sensor specifications

---

**This architecture provides a solid foundation for a scalable, maintainable real-time CO2 monitoring system! ğŸš€**
